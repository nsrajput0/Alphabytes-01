<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>EarthLens</title>
  <link rel="stylesheet" href="style.css">
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    /* Add this in <head> or your CSS file for better dropdown positioning */
    nav ul .dropdown {
      position: relative;
    }
    nav ul .dropdown-menu {
      min-width: 140px;
      left: 0;
      top: 100%;
    }
  </style>
</head>
  <body style="background-color: black;">
  <!-- Rocket Launch Animation Overlay -->
  <div id="rocket-video-overlay" style="position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:1000; background:linear-gradient(135deg,#101a2b 60%,#1a2233 100%); overflow:hidden;">
    <canvas id="rocket-stars-bg" style="position:absolute;top:0;left:0;width:100vw;height:100vh;z-index:1;"></canvas>
    <canvas id="rocket-launch-canvas" style="position:absolute;top:0;left:0;width:100vw;height:100vh;z-index:2;"></canvas>
    <canvas id="rocket-smoke-canvas" style="position:absolute;left:0;top:0;width:100vw;height:100vh;z-index:3;pointer-events:none;"></canvas>
  </div>
  <div id="site-content" style="display:none; background-color: black;">
    <canvas id="stars-bg"></canvas>
    <div class="sprinkles-bg" id="sprinkles-bg"></div>
    <header>
    <nav>
      <div class="logo">EarthLens</div>
      <button class="nav-toggle" aria-label="Toggle navigation">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <ul>
        <li><a href="#" data-section="home" class="nav-link active">Home</a></li>
        <li><a href="#" data-section="dashboard" class="nav-link">Dashboard</a></li>
        <li><a href="#" data-section="solar-system" class="nav-link">Solar System</a></li>
        <!-- Dropdown for Study NASA -->
        <li class="dropdown">
          <a href="#" data-section="study" class="nav-link">Study NASA ‚ñº</a>
          <ul class="dropdown-menu" style="display:none;position:absolute;background:#1a2233;padding:1em;border-radius:8px;z-index:10;">
            <li style="padding: 0.4rem 0"><a href="#" class="study-dropdown-link" data-study="history" >Our History</a></li>
            <li style="padding: 0.4rem 0"><a href="#" class="study-dropdown-link" data-study="wins">Achievements</a></li>
            <li style="padding: 0.4rem 0"><a href="#" class="study-dropdown-link" data-study="losses">Our failures</a></li>
            <li style="padding: 0.4rem 0"><a href="#" class="study-dropdown-link" data-study="future">Future Missions</a></li>
          </ul>
        </li>
        <li><a href="#" data-section="quiz" class="nav-link">Quiz</a></li>
        <li><a href="#" data-section="about" class="nav-link">About</a></li>
      </ul> 
    </nav> 
  </header>

  <main>
    <!-- Home Section -->
    <section id="home" class="main-section">
      <h1>EarthLens</h1> 
      <p>Explore NASA's open data about Earth and Space. Get live information on natural events, air quality, and more.</p>
      <div class="hero-img"></div>
      <div class="home-extra">
        <div class="home-cards">
          <div class="home-card" id="home-apod-preview">
            <h3>Today's Space Image</h3>
            <div id="home-apod-img"></div>
          </div>
          <div class="home-card" id="home-fact">
            <h3>Did You Know?</h3>
            <div id="home-nasa-fact"></div>
          </div>
        </div>
        <div class="home-cta">
          <h3>Become a Citizen Scientist!</h3>
          <p>Check the <b>Dashboard</b> for live events, or visit <b>Study NASA</b> to learn more about NASA's missions and discoveries.</p>
        </div>
      </div>
    </section>

    <!-- Dashboard Section -->
    <section id="dashboard" class="main-section" style="display:none;">
      <h2>Live NASA Data Dashboard</h2>
      <div class="dashboard-grid">
        <!-- EONET Events -->
        <div class="dashboard-card" id="events-section">
          <h3>Recent Natural Events</h3>
          <div id="events-list" class="events-list"></div>
        </div>
        <!-- User Location -->
        <div class="dashboard-card" id="location-section">
          <h3>Your Location</h3>
          <div id="user-location">Detecting location...</div>
          <div id="user-temp"></div>
          <div id="user-time"></div>
        </div>
        <!-- Air Quality -->
        <div class="dashboard-card" id="air-quality-section">
          <h3>Air Quality</h3>
          <div id="air-quality-content">Loading air quality...</div>
        </div>
        <!-- Map -->
        <div class="dashboard-card map-card">
          <h3>Event Map</h3>
          <div id="map" style="height:300px;"></div>
        </div>
        <!-- Chart -->
        <div class="dashboard-card">
          <h3>Events by Category</h3>
          <canvas id="events-chart" width="400" height="250"></canvas>
        </div>
        <!-- APOD -->
        <div class="dashboard-card" id="apod-section">
          <h3>Astronomy Picture of the Day</h3>
          <div id="apod-content"></div>
        </div>
        
        <!-- NASA News -->
        <div class="dashboard-card" id="news-section">
          <h3>NASA News</h3>
          <div id="nasa-news-list"></div>
        </div>
      </div>
    </section>

    <!-- Solar System Section -->
    <section id="solar-system" class="main-section" style="display:none;">
      <h2>Solar System Model</h2>
      <div class="solar-system-container">
        <div id="solar-system-canvas"></div>
      </div>

        <!-- Info box for planet/sun details -->
      <p style="color:#a3b9cc; margin-top:1em;">Planets revolve around the Sun at relative speeds and distances. (Not to scale)</p>
      <div id="planet-info" style="margin-top:2em; background:#1a2233; color:#fff; padding:1em; border-radius:8px;  display:none; z-index:20;"></div>
      
    </section>

    <!-- Study NASA Section -->
    <section id="study" class="main-section" style="display:none;">
      <h2>Study NASA</h2>
      <!-- Dropdown section selector -->
      <div style="margin-bottom:1em;">
<<<<<<< HEAD
        <button class="study-section-btn" data-study="history">History of NASA</button>
        <button class="study-section-btn" data-study="wins">Sucess of NASA</button>
        <button class="study-section-btn" data-study="losses">Failures of NASA</button>
        <button class="study-section-btn" data-study="future">Future Missions</button>
=======
        <button class="study-section-btn" data-study="history">History</button>
        <button class="study-section-btn" data-study="wins">Wins</button>
        <button class="study-section-btn" data-study="losses">Losses</button>
>>>>>>> parent of 250f32c (changed information)
      </div>
      <div class="study-content">
        <!-- History Section -->
        <div id="study-history" class="study-subsection">
          <div class="study-media" style="width:100%;margin-bottom:2em;display:flex;flex-wrap:wrap;gap:2em;justify-content:center;">
          </div>
          <div class="study-info">
            <h3>History of NASA</h3>
            <p>
              üöÄ The Complete History of NASA <br>

  üåç Origins <br>

  Founded: July 29, 1958 (by National Aeronautics and Space Act). <br>

  Reason: Cold War tensions & the USSR‚Äôs launch of Sputnik 1 (1957). <br>

  Predecessor: NACA (National Advisory Committee for Aeronautics, founded in 1915). <br>

  Official Start: October 1, 1958. <br><br>


  üëâ First Administrator: Dr. T. Keith Glennan <br>
  üëâ Motto: ‚ÄúFor the Benefit of All.‚Äù <br> <br> <br>


  ---
  <br>
  üßë‚ÄçüöÄ The Space Race Era (1958‚Äì1969) <br>

  Project Mercury (1959‚Äì63): <br>

  Goal ‚Üí Send first Americans into space. <br>

  1961: Alan Shepard ‚Üí 1st American in space. <br>

  1962: John Glenn ‚Üí 1st American to orbit Earth. <br><br>


  Project Gemini (1961‚Äì66): <br>

  Practiced spacewalks, docking, and long-duration flights. <br>

  Helped prepare astronauts for the Moon. <br>


  Apollo Program (1961‚Äì72): <br>

  Announced by President John F. Kennedy (1961): ‚ÄúWe choose to go to the Moon.‚Äù <br>

  Apollo 8 (1968): 1st crewed spacecraft to orbit the Moon. <br>

  Apollo 11 (1969): Neil Armstrong & Buzz Aldrin walked on the Moon. <br>

  Six Moon landings in total (Apollo 11‚Äì17, except 13 due to in-flight emergency). <br> <br><br>




  --- <br>

  üõ∞Ô∏è Post-Apollo Achievements (1970s‚Äì1980s) <br>

  Skylab (1973‚Äì79): America‚Äôs first space station. <br>

  Apollo-Soyuz Test Project (1975): First U.S.‚ÄìSoviet joint mission ‚Üí symbol of peace. <br>

  Voyager Probes (1977): Sent to study outer planets (still sending signals today üåå). <br>

  Space Shuttle Program (1981‚Äì2011): <br>

  Reusable spacecraft (Columbia, Challenger, Discovery, Atlantis, Endeavour). <br>

  Challenger disaster (1986) ‚Üí Shuttle exploded after launch. <br>

  Revolutionized satellite deployment & ISS construction. <br><br><br>




  --- <br>

  üåå The Modern Space Age (1990s‚Äì2000s) <br>

  Hubble Space Telescope (1990): Gave breathtaking deep-space images. <br>

  International Space Station (1998‚ÄìPresent): Built by NASA + Russia + partners. <br>

  Mars Exploration Rovers (2003): Spirit & Opportunity explored the Red Planet. <br>

  Columbia Disaster (2003): Shuttle disintegrated on re-entry ‚Üí 7 astronauts lost. <br><br><br>



  --- <br>

  ‚ú® The New Era (2010s‚ÄìPresent) <br>

  Curiosity Rover (2012): Landed on Mars with advanced science lab. <br>

  New Horizons (2015): Flyby mission ‚Üí first detailed images of Pluto. <br>

  Perseverance Rover (2021): Searching for signs of ancient life on Mars. <br>

  James Webb Space Telescope (2021): Most powerful telescope ever launched. <br>

  Commercial Partnerships: Collaborating with SpaceX, Blue Origin, Boeing, etc. <br>

  Artemis Program (Ongoing): <br>

  Goal ‚Üí Return astronauts to the Moon by mid-2020s. <br>

  Special focus: First woman and first person of color on the Moon. <br>

  Long-term ‚Üí Use Moon as base for Mars missions. <br><br><br>




  --- <br>

  üìç Fun Facts about NASA <br>

  Budget (2024): ~$25 billion. <br>

  NASA inventions used in daily life: memory foam, scratch-resistant lenses, water filters, cordless tools, freeze-dried food. <br>

  NASA‚Äôs motto: ‚ÄúExplore. Discover. Understand.‚Äù <br>

  NASA has 10 major research centers across the U.S. (e.g., Kennedy Space Center, Johnson Space Center, Jet Propulsion Laboratory). <br><br><br>



  --- <br>

  üëâ In short, NASA‚Äôs journey is like this: <br>
  Sputnik shock ‚Üí Mercury rockets ‚Üí Apollo Moon landing ‚Üí Space Shuttle & ISS ‚Üí Mars rovers & Hubble ‚Üí Artemis & Webb for the futureüåå‚ú®
            </p>
            </div>
          <div class="study-links">
            <h3>Learn More</h3>
            <ul>
              <li><a href="https://youtu.be/VV6QeZFaVSQ?si=w76kiTzLfmqgiGEe" target="_blank">More About NASA's History</a></li>
            </ul>
          </div>
        </div>
        <!-- Wins Section -->
        <div id="study-wins" class="study-subsection" style="display:none;">
          <div class="study-info">
            <h3>NASA Wins</h3>
            <ul>
              <li>Apollo 11 Moon landing (1969)</li> 
              <li>Voyager probes exploring outer planets</li>
              <li>Hubble Space Telescope discoveries</li>
              <li>Mars rovers (Spirit, Opportunity, Curiosity, Perseverance)</li>
              <li>International Space Station collaboration</li>
              <li>James Webb Space Telescope launch</li>
              <li>Commercial partnerships (SpaceX, Artemis program)</li>
            </ul>
          </div>
        </div>
        <!-- Losses Section -->
        <div id="study-losses" class="study-subsection" style="display:none;">
          <div class="study-info">
            <h3>NASA Losses</h3>
            <ul>
              <li>Challenger disaster (1986)</li>
              <li>Columbia disaster (2003)</li>
              <li>Apollo 13 mission failure (1970, no Moon landing)</li>
              <li>Budget cuts and cancelled missions</li>
              <li>Technical failures and launch delays</li>
            </ul>
          </div>
        </div>
        <!-- Future Missions Section -->
        <div id="study-future" class="study-subsection" style="display:none;">
          <div class="study-info" style="background:#1b2130; border-radius:0.7rem; padding:1rem 1.2rem; color:#f7fafc;">
            <h3 style="color:#e63946;">NASA Future Missions</h3>
            <ul>
              <li>
                <b>Artemis Program:</b> <br>
                <span>Return humans to the Moon, establish a sustainable lunar base, and prepare for Mars missions. Artemis II (first crewed lunar flyby, planned 2025), Artemis III (first woman and next man on the Moon).</span>
              </li><br>
              <li>
                <b>Mars Sample Return:</b> <br>
                <span>Joint NASA/ESA mission to bring Martian soil samples collected by Perseverance rover back to Earth (late 2020s).</span>
              </li><br>
              <li>
                <b>Europa Clipper:</b> <br>
                <span>Launch in 2024 to study Jupiter‚Äôs moon Europa, searching for signs of life beneath its icy surface.</span>
              </li><br>
              <li>
                <b>Dragonfly Mission:</b> <br>
                <span>Launch in 2027, drone-like rotorcraft to explore Saturn‚Äôs moon Titan, investigating prebiotic chemistry and habitability.</span>
              </li><br>
              <li>
                <b>Nancy Grace Roman Space Telescope:</b> <br>
                <span>Launch mid-2020s, wide-field infrared telescope to study dark energy, exoplanets, and cosmic origins.</span>
              </li><br>
              <li>
                <b>VERITAS & DAVINCI+ (Venus Missions):</b> <br>
                <span>Planned launches late 2020s, to study Venus‚Äô geology, atmosphere, and history.</span>
              </li> <br>
              <li>
                <b>Gateway Lunar Space Station:</b> <br>
                <span>International outpost orbiting the Moon, supporting Artemis and deep space missions.</span>
              </li><br>
              <li>
                <b>Exoplanet Exploration:</b> <br>
                <span>Future telescopes and missions to discover and characterize planets around other stars.</span>
              </li><br>
            </ul>
            <p>
              <b>NASA‚Äôs vision for the future:</b> Expand human presence beyond Earth, search for life, understand our origins, and inspire new generations of explorers.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Quiz Section -->
    <section id="quiz" class="main-section" style="display:none;">
      <h2>NASA Quiz</h2>
      <div id="quiz-paragraph" class="quiz-paragraph"></div>
      <form id="quiz-form">
        <div id="quiz-questions"></div>
        <button type="submit" id="quiz-submit">Submit Answers</button>
      </form>
      <div id="quiz-result"></div>
    </section>

    <!-- About Section -->
    <section id="about" class="main-section" style="display:none;">
      <h2>About Citizen Science Dashboard</h2>
      <div class="about-beautiful">
        <div class="about-mission">
          <h3>Our Mission</h3>
          <p>
            <b>Citizen Science Dashboard</b> empowers everyone to explore and understand our planet and universe using NASA's open data.<br>
            <span class="about-highlight">Track real-time natural events, see your location on a live map, enjoy daily space images, and stay updated with NASA news.</span>
          </p>
        </div>
        <div class="about-features">
          <h3>Features</h3>
          <ul>
            <li>üåç Live natural event tracking (wildfires, storms, volcanoes, floods)</li>
            <li>üìç Your location, temperature, and local time</li>
            <li>üó∫Ô∏è Interactive world map</li>
            <li>üìä Event statistics and charts</li>
            <li>üì∞ Latest NASA news</li>
            <li>üåå Astronomy Picture of the Day</li>
            <li>üìö Study NASA facts and resources</li>
          </ul>
        </div>
        <div class="about-resources">
          <h3>Resources</h3>
          <ul>
            <li><a href="https://eonet.gsfc.nasa.gov/docs/v3" target="_blank">NASA EONET API</a></li>
            <li><a href="https://api.nasa.gov/" target="_blank">NASA Open APIs</a></li>
            <li><a href="https://apod.nasa.gov/apod/astropix.html" target="_blank">Astronomy Picture of the Day</a></li>
            <li><a href="https://www.nasa.gov/news/releases/latest/index.html" target="_blank">NASA Newsroom</a></li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>Made for NASA Space Apps Challenge 2025</p>
  </footer>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="script.js"></script>
  <script>
    // Show homepage after rocket animation ends
    window.addEventListener('DOMContentLoaded', function() {
      // Stars background for rocket overlay
      var starsCanvas = document.getElementById('rocket-stars-bg');
      if (starsCanvas) {
        starsCanvas.width = window.innerWidth;
        starsCanvas.height = window.innerHeight;
        var ctx = starsCanvas.getContext('2d');
        for (var i=0; i<120; i++) {
          var x = Math.random()*starsCanvas.width;
          var y = Math.random()*starsCanvas.height;
          var r = Math.random()*1.2+0.3;
          ctx.beginPath();
          ctx.arc(x, y, r, 0, 2*Math.PI);
          ctx.fillStyle = '#fff';
          ctx.globalAlpha = Math.random()*0.7+0.3;
          ctx.fill();
        }
        ctx.globalAlpha = 1;
      }

      // Rocket launch animation
      var rocketCanvas = document.getElementById('rocket-launch-canvas');
      var smokeCanvas = document.getElementById('rocket-smoke-canvas');
      if (rocketCanvas && smokeCanvas) {
        rocketCanvas.width = window.innerWidth;
        rocketCanvas.height = window.innerHeight;
        smokeCanvas.width = window.innerWidth;
        smokeCanvas.height = window.innerHeight;
        var ctx = rocketCanvas.getContext('2d');
        var smokeCtx = smokeCanvas.getContext('2d');
        var w = rocketCanvas.width, h = rocketCanvas.height;
        var rocketY = h * 0.85;
        var rocketX = w/2;
        var frame = 0;
        var rocketHeight = h * 0.18;
        var rocketWidth = rocketHeight * 0.18;
        var smokeParticles = [];
        var fireParticles = [];
        var launchPhase = true;
        var fadeOutFrame = 0;

        // --- Themed Rocket Drawing ---
        function drawRocket(x, y) {
          ctx.save();
          ctx.translate(x, y);

          // Body (gradient: accent to secondary)
          var bodyGrad = ctx.createLinearGradient(-rocketWidth/2, -rocketHeight, rocketWidth/2, 0);
          bodyGrad.addColorStop(0, "#3ec6e0");
          bodyGrad.addColorStop(1, "#23293a");
          ctx.beginPath();
          ctx.rect(-rocketWidth/2, -rocketHeight, rocketWidth, rocketHeight);
          ctx.fillStyle = bodyGrad;
          ctx.shadowColor = "#3ec6e0";
          ctx.shadowBlur = 18;
          ctx.fill();
          ctx.shadowBlur = 0;

          // Nose cone (secondary color)
          ctx.beginPath();
          ctx.moveTo(-rocketWidth/2, -rocketHeight);
          ctx.lineTo(0, -rocketHeight-rocketWidth*1.2);
          ctx.lineTo(rocketWidth/2, -rocketHeight);
          ctx.closePath();
          ctx.fillStyle = "#a3b9cc";
          ctx.fill();

          // Window (accent color, with glow)
          ctx.save();
          ctx.beginPath();
          ctx.arc(0, -rocketHeight*0.7, rocketWidth*0.22, 0, 2*Math.PI);
          ctx.fillStyle = "#3ec6e0";
          ctx.shadowColor = "#3ec6e0";
          ctx.shadowBlur = 12;
          ctx.fill();
          ctx.restore();

          // Fins (accent)
          ctx.beginPath();
          ctx.moveTo(-rocketWidth/2, -rocketHeight*0.2);
          ctx.lineTo(-rocketWidth*0.9, 0);
          ctx.lineTo(-rocketWidth/2, 0);
          ctx.closePath();
          ctx.fillStyle = "#3ec6e0";
          ctx.fill();

          ctx.beginPath();
          ctx.moveTo(rocketWidth/2, -rocketHeight*0.2);
          ctx.lineTo(rocketWidth*0.9, 0);
          ctx.lineTo(rocketWidth/2, 0);
          ctx.closePath();
          ctx.fillStyle = "#3ec6e0";
          ctx.fill();

          // Decorative stripe (horizontal, secondary)
          ctx.beginPath();
          ctx.rect(-rocketWidth/2, -rocketHeight*0.45, rocketWidth, rocketHeight*0.09);
          ctx.fillStyle = "#a3b9cc";
          ctx.globalAlpha = 0.7;
          ctx.fill();
          ctx.globalAlpha = 1;

          // --- Flame (big, animated, realistic) ---
          var flameLen = rocketHeight*0.55 + Math.sin(frame/2)*rocketHeight*0.12;
          ctx.save();
          ctx.beginPath();
          ctx.moveTo(-rocketWidth/2.2, 0);
          ctx.bezierCurveTo(-rocketWidth/2, flameLen*0.5, rocketWidth/2, flameLen*0.5, rocketWidth/2.2, 0);
          ctx.lineTo(0, flameLen);
          ctx.closePath();
          var flameGrad = ctx.createLinearGradient(0, 0, 0, flameLen);
          flameGrad.addColorStop(0, "#fff");
          flameGrad.addColorStop(0.2, "#ffd700");
          flameGrad.addColorStop(0.5, "#ff9800");
          flameGrad.addColorStop(0.8, "#e05c3e");
          flameGrad.addColorStop(1, "#f44336");
          ctx.globalAlpha = 0.92;
          ctx.fillStyle = flameGrad;
          ctx.shadowColor = "#ffd700";
          ctx.shadowBlur = 24;
          ctx.fill();
          ctx.shadowBlur = 0;
          ctx.globalAlpha = 1;
          ctx.restore();

          ctx.restore();
        }

        // --- Fire Particle Drawing ---
        function drawFire() {
          for (var i=0; i<fireParticles.length; i++) {
            var p = fireParticles[i];
            smokeCtx.save();
            smokeCtx.globalAlpha = p.alpha;
            smokeCtx.beginPath();
            smokeCtx.arc(p.x, p.y, p.radius, 0, 2*Math.PI);
            var grad = smokeCtx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.radius);
            grad.addColorStop(0, "rgba(255,255,200,0.9)");
            grad.addColorStop(0.3, "rgba(255,180,60,0.7)");
            grad.addColorStop(0.7, "rgba(255,80,0,0.4)");
            grad.addColorStop(1, "rgba(255,0,0,0.1)");
            smokeCtx.fillStyle = grad;
            smokeCtx.fill();
            smokeCtx.restore();
            p.x += p.vx;
            p.y += p.vy;
            p.radius += 0.3 + Math.random()*0.3;
            p.alpha -= 0.02 + Math.random()*0.01;
          }
          fireParticles = fireParticles.filter(p => p.alpha > 0.05);
        }

        // --- Smoke Particle Drawing ---
        function drawSmoke() {
          smokeCtx.clearRect(0, 0, w, h);
          drawFire();
          for (var i=0; i<smokeParticles.length; i++) {
            var p = smokeParticles[i];
            smokeCtx.save();
            smokeCtx.globalAlpha = p.alpha;
            smokeCtx.beginPath();
            smokeCtx.arc(p.x, p.y, p.radius, 0, 2*Math.PI);
            var grad = smokeCtx.createRadialGradient(p.x, p.y, 0, p.x, p.y, p.radius);
            grad.addColorStop(0, "rgba(255,255,255,0.85)");
            grad.addColorStop(0.5, "rgba(220,220,220,0.5)");
            grad.addColorStop(1, "rgba(200,200,200,0.1)");
            smokeCtx.fillStyle = grad;
            smokeCtx.fill();
            smokeCtx.restore();
            p.x += p.vx;
            p.y += p.vy;
            p.radius += 0.7 + Math.random()*0.8;
            p.alpha -= 0.008 + Math.random()*0.004;
          }
          smokeParticles = smokeParticles.filter(p => p.alpha > 0.05);
        }

        // --- Animation Loop ---
        function animateRocket() {
          ctx.clearRect(0, 0, w, h);

          // Fade out everything after launch
          var overlay = document.getElementById('rocket-video-overlay');
          if (!launchPhase && fadeOutFrame < 60) {
            overlay.style.opacity = (1 - fadeOutFrame/60).toFixed(2);
            fadeOutFrame++;
          }

          // Draw rocket
          if (launchPhase || fadeOutFrame < 60) {
            drawRocket(rocketX, rocketY);
          }

          // Add fire and smoke particles at rocket base
          if (launchPhase && rocketY > 0) {
            for (var i=0; i<22; i++) { // lots of fire
              fireParticles.push({
                x: rocketX + (Math.random()-0.5)*rocketWidth*1.2,
                y: rocketY + rocketHeight*0.1 + Math.random()*18,
                radius: rocketWidth*0.18 + Math.random()*rocketWidth*0.22,
                alpha: 0.7 + Math.random()*0.2,
                vx: (Math.random()-0.5)*1.2,
                vy: 2.5 + Math.random()*1.2
              });
            }
            for (var i=0; i<18; i++) { // lots of smoke
              smokeParticles.push({
                x: rocketX + (Math.random()-0.5)*rocketWidth*1.5,
                y: rocketY + rocketHeight*0.1 + Math.random()*22,
                radius: rocketWidth*0.7 + Math.random()*rocketWidth*0.7,
                alpha: 0.55 + Math.random()*0.25,
                vx: (Math.random()-0.5)*1.8,
                vy: 2.2 + Math.random()*1.2
              });
            }
          }
          drawSmoke();

          // Move rocket up
          if (launchPhase) {
            // Detect phone mode (mobile)
            var isMobile = window.innerWidth <= 700 || window.innerHeight <= 700;
            var baseSpeed = h * 0.012 + Math.max(0, Math.sin(frame/12))*h*0.004;
            // On phone, make rocket much faster (relative to height)
            var speed = isMobile ? h * 0.028 + Math.max(0, Math.sin(frame/8))*h*0.008 : baseSpeed;
            rocketY -= speed;
            frame++;
            // End launch phase when rocket leaves screen
            if (rocketY < -rocketHeight*2) {
              launchPhase = false;
              fadeOutFrame = 0;
            }
          }

          // Fade out overlay and smoke naturally
          if (!launchPhase && fadeOutFrame >= 60) {
            overlay.style.transition = "opacity 1.2s";
            overlay.style.opacity = 0;
            setTimeout(function() {
              overlay.style.display = 'none';
              document.getElementById('site-content').style.display = '';
            }, 1200);
            return;
          }

          requestAnimationFrame(animateRocket);
        }
        animateRocket();
      }
    });
  </script>
  <script>
    // Responsive navbar toggle
    document.addEventListener('DOMContentLoaded', function() {
      var navToggle = document.querySelector('.nav-toggle');
      var navMenu = document.querySelector('nav ul');
      navToggle.addEventListener('click', function() {
        navMenu.classList.toggle('show');
      });
      // Close menu on link click (mobile)
      navMenu.querySelectorAll('a').forEach(function(link) {
        link.addEventListener('click', function() {
          if(window.innerWidth <= 700) navMenu.classList.remove('show');
        });
      });
      // Optional: close menu on outside click
      document.addEventListener('click', function(e) {
        if(window.innerWidth > 700) return;
        if(!navMenu.contains(e.target) && !navToggle.contains(e.target)) {
          navMenu.classList.remove('show');
        }
      });
    });
  </script>
  <script>
    // Responsive solar system canvas (if using JS for rendering)
    window.addEventListener('DOMContentLoaded', function() {
      function resizeSolarCanvas() {
        var el = document.getElementById('solar-system-canvas');
        if (el && el.tagName === 'CANVAS') {
          var rect = el.getBoundingClientRect();
          el.width = rect.width;
          el.height = rect.height;
          // Optionally: re-render solar system here if needed
        }
      }
      resizeSolarCanvas();
      window.addEventListener('resize', resizeSolarCanvas);
    });
  </script>
  <script>
  // Air Quality Summary Logic
  function summarizeAirQuality(aqi) {
    if (aqi === null || aqi === undefined) return "Unknown";
    if (aqi <= 50) return "Good";
    if (aqi <= 100) return "Moderate";
    if (aqi <= 150) return "Unhealthy for Sensitive Groups";
    if (aqi <= 200) return "Unhealthy";
    if (aqi <= 300) return "Very Unhealthy";
    return "Hazardous";
  }

  function updateAirQualitySection(aqi, details) {
  var summary = summarizeAirQuality(aqi);
  var color = aqi<=50?'#3ee07a':aqi<=100?'#ffd700':aqi<=150?'#e05c3e':'#d32f2f';
  var content = `<div><b>Status:</b> <span style="color:${aqi ? color : '#888'}">${aqi ? summary : 'No data available'}</span></div>`;
  if (details) content += `<div style="margin-top:0.5em;">${details}</div>`;
  document.getElementById('air-quality-content').innerHTML = content;
}

  // Fetch air quality data using OpenAQ API and browser geolocation
  function fetchAirQuality() {
    if (!navigator.geolocation) {
      updateAirQualitySection(null, "Location not available.");
      return;
    }
    navigator.geolocation.getCurrentPosition(function(pos) {
      var lat = pos.coords.latitude;
      var lon = pos.coords.longitude;
      // OpenAQ API for nearest measurements
      fetch(`https://api.openaq.org/v2/latest?coordinates=${lat},${lon}&radius=10000&limit=1`)
        .then(res => res.json())
        .then(data => {
          if (data.results && data.results.length > 0) {
            var m = data.results[0].measurements;
            var pm25 = m.find(x => x.parameter === "pm25");
            var pm10 = m.find(x => x.parameter === "pm10");
            var aqi = pm25 ? Math.round(pm25.value) : (pm10 ? Math.round(pm10.value) : null);
            var details = "";
            if (pm25) details += `PM2.5: ${pm25.value} ${pm25.unit}<br>`;
            if (pm10) details += `PM10: ${pm10.value} ${pm10.unit}<br>`;
            details += `Location: ${data.results[0].city || "Unknown"}`;
            updateAirQualitySection(aqi, details);
          } else {
            updateAirQualitySection(null, "No air quality data found for your location.");
          }
        })
        .catch(() => {
          updateAirQualitySection(null, "Unable to fetch air quality data.");
        });
    }, function() {
      updateAirQualitySection(null, "Location access denied.");
    });
  }

  // Auto-fetch air quality on page load
  window.addEventListener('DOMContentLoaded', fetchAirQuality);
  </script>
  <script>
  // Dropdown menu logic for Study NASA nav
  document.addEventListener('DOMContentLoaded', function() {
    var dropdown = document.querySelector('.dropdown');
    var dropdownMenu = dropdown.querySelector('.dropdown-menu');
    var studySection = document.getElementById('study');
    var mainSections = document.querySelectorAll('.main-section');
    var studySubsections = document.querySelectorAll('.study-subsection');

    // Helper: show only one study subsection
    function showStudySubsection(name) {
      studySubsections.forEach(function(sec) {
        sec.style.display = 'none';
      });
      var section = document.getElementById('study-' + name);
      if (section) section.style.display = '';
    }

    // Show dropdown on hover (desktop)
    dropdown.addEventListener('mouseenter', function() {
      dropdownMenu.style.display = 'block';
    });
    dropdown.addEventListener('mouseleave', function() {
      dropdownMenu.style.display = 'none';
    });

    // Toggle dropdown on click (mobile)
    dropdown.querySelector('.nav-link').addEventListener('click', function(e) {
      e.preventDefault();
      dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
    });

    // Dropdown menu item click
    dropdownMenu.querySelectorAll('.study-dropdown-link').forEach(function(link) {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        // Hide all main sections, show Study NASA
        mainSections.forEach(function(sec) { sec.style.display = 'none'; });
        studySection.style.display = '';
        // Show correct subsection
        showStudySubsection(link.getAttribute('data-study'));
        // Hide dropdown
        dropdownMenu.style.display = 'none';
      });
    });

    // When Study NASA section is shown (from nav), default to History
    document.querySelector('a[data-section="study"]').addEventListener('click', function(e) {
      // Only run if not from dropdown menu
      if (!e.target.classList.contains('study-dropdown-link')) {
        mainSections.forEach(function(sec) { sec.style.display = 'none'; });
        studySection.style.display = '';
        showStudySubsection('history');
        dropdownMenu.style.display = 'none';
        e.preventDefault();
      }
    });

    // Button selector logic inside Study NASA section
    document.querySelectorAll('.study-section-btn').forEach(function(btn) {
      btn.addEventListener('click', function() {
        showStudySubsection(btn.getAttribute('data-study'));
      });
    });

    // On page load, default to showing History subsection if Study NASA is shown
    if (studySection.style.display !== 'none') {
      showStudySubsection('history');
    }
  });
  </script>
  <script>
    // Quiz section: use APOD paragraph for quiz
    document.addEventListener('DOMContentLoaded', function() {
      fetch('https://api.nasa.gov/planetary/apod?api_key=4pikVJsdIWZvaOuqMzzskcOXkFz2MMb4lL95xNlW')
        .then(res => res.json())
        .then(data => {
          document.getElementById('quiz-paragraph').textContent = data.explanation;

          // Generate quiz questions from APOD data
          var questions = [
            {
              q: "What is the title of today's Astronomy Picture of the Day?",
              options: [data.title, "Milky Way", "Mars Rover", "Hubble Deep Field"],
              answer: 0
            },
            {
              q: "What is the date of today's APOD?",
              options: [data.date, "2022-01-01", "2023-05-10", "2024-06-01"],
              answer: 0
            },
            {
              q: "Does the APOD explanation mention the word 'nebula'?",
              options: ["yes", "no"],
              answer: data.explanation.toLowerCase().includes('nebula') ? 0 : 1
            },
            {
              q: "Is the APOD media type an image?",
              options: ["yes", "no"],
              answer: data.media_type === "image" ? 0 : 1
            },
            {
              q: "Which NASA API is used for Astronomy Picture of the Day?",
              options: [
                "planetary/apod",
                "mars-photos/api/v1/rovers",
                "eonet/api/v3/events",
                "neo/rest/v1/feed"
              ],
              answer: 0
            },
            {
              q: "What is the main subject of today's APOD?",
              options: [
                data.title,
                "A planet",
                "A galaxy",
                "A comet"
              ],
              answer: 0
            }
          ];

          var quizQuestionsDiv = document.getElementById('quiz-questions');
          quizQuestionsDiv.innerHTML = '';
          questions.forEach(function(q, idx) {
            quizQuestionsDiv.innerHTML += `
              <div class="quiz-question">
                <label>${q.q}</label>
                <div class="quiz-options">
                  ${q.options.map((opt, i) =>
                    `<label><input type="radio" name="q${idx}" value="${i}"> ${opt}</label>`
                  ).join('<br>')}
                </div>
              </div>
            `;
          });

          document.getElementById('quiz-form').onsubmit = function(e) {
            e.preventDefault();
            var score = 0;
            questions.forEach(function(q, idx) {
              var radios = document.getElementsByName('q' + idx);
              var selected = -1;
              for (var r of radios) {
                if (r.checked) selected = parseInt(r.value);
              }
              if (selected === q.answer) score++;
            });
            document.getElementById('quiz-result').textContent =
              `You scored ${score} out of ${questions.length}.`;
          };
        });
    });
  </script>
  <script>
// Chatbot Q&A logic (JSON-based)
const chatbotQA = [
  {
    q: ["what is earthlens", "what does earthlens do", "about earthlens", "what is this website"],
    a: "EarthLens is a citizen science dashboard that lets you explore NASA's open data about Earth and Space, including live natural events, air quality, solar system info, and more."
  },
  {
    q: ["how do i see nasa events", "show me nasa events", "natural events", "dashboard events"],
    a: "Go to the Dashboard section to see recent NASA-tracked natural events like wildfires, floods, storms, and volcanoes. You can also view them on the interactive map."
  },
  {
    q: ["what is apod", "astronomy picture of the day", "space image", "today's space image"],
    a: "APOD stands for Astronomy Picture of the Day. Each day, NASA shares a stunning space image with an explanation. You can see it on the Home and Dashboard sections."
  },
  {
    q: ["how do i check air quality", "air quality", "is my air clean", "dashboard air quality"],
    a: "The Dashboard section shows your local air quality using open data. It includes PM2.5, PM10, carbon monoxide, and ozone levels."
  },
  {
    q: ["solar system", "show me planets", "solar system model", "planets info"],
    a: "Visit the Solar System section for an interactive model. Click on any planet or the Sun to learn facts about them."
  },
  {
    q: ["quiz", "nasa quiz", "how to play quiz", "test my knowledge"],
    a: "Go to the Quiz section to answer questions generated from NASA's Astronomy Picture of the Day. Submit your answers to see your score."
  },
  {
    q: ["study nasa", "nasa history", "nasa achievements", "nasa failures"],
    a: "The Study NASA section lets you learn about NASA's history, achievements, and failures. You can also find links to official NASA resources."
  },
  {
    q: ["resources", "api", "where does data come from", "data sources"],
    a: "EarthLens uses NASA EONET, APOD, OpenAQ, Open-Meteo, SoilGrids, and NASA News APIs for live data. See the About section for more details."
  },
  {
    q: ["who made this", "team", "challenge", "space apps"],
    a: "This dashboard was made by AlphaBytes Team for the NASA Space Apps Challenge 2025."
  }
];

// Utility: Find best answer for a question
function chatbotFindAnswer(userQ) {
  const qNorm = userQ.trim().toLowerCase();
  for (const qa of chatbotQA) {
    for (const q of qa.q) {
      if (qNorm.includes(q)) return qa.a;
    }
  }
  // Fallback: Only answer questions about the website
  if (
    qNorm.includes("nasa") ||
    qNorm.includes("dashboard") ||
    qNorm.includes("solar system") ||
    qNorm.includes("apod") ||
    qNorm.includes("quiz") ||
    qNorm.includes("event") ||
    qNorm.includes("air quality") ||
    qNorm.includes("resources") ||
    qNorm.includes("earthlens")
  ) {
    return "Sorry, I can only answer questions about EarthLens, NASA data, dashboard features, solar system, quiz, and resources. Try asking about those!";
  }
  return "Sorry, I can only answer questions related to this website (EarthLens, NASA data, dashboard, solar system, quiz, resources).";
}

// Chatbot UI logic
document.addEventListener('DOMContentLoaded', function() {
  const chatbotToggle = document.getElementById('chatbot-toggle');
  const chatbotWindow = document.getElementById('chatbot-window');
  const chatbotForm = document.getElementById('chatbot-form');
  const chatbotInput = document.getElementById('chatbot-input');
  const chatbotMessages = document.getElementById('chatbot-messages');
  const chatbotClose = document.getElementById('chatbot-close');

  chatbotToggle.onclick = function() {
    chatbotWindow.style.display = 'flex';
    chatbotToggle.style.display = 'none';
    chatbotInput.focus();
    chatbotMessages.innerHTML = '<div style="margin-bottom:0.7em;">üëã Hi! Ask me anything about EarthLens, NASA data, dashboard, solar system, quiz, or resources.</div>';
  };
  chatbotClose.onclick = function() {
    chatbotWindow.style.display = 'none';
    chatbotToggle.style.display = '';
  };
  chatbotForm.onsubmit = function(e) {
    e.preventDefault();
    const userQ = chatbotInput.value.trim();
    if (!userQ) return;
    const userMsg = document.createElement('div');
    userMsg.style = "margin:0.5em 0;text-align:right;";
    userMsg.innerHTML = `<span style="background:#7c4dff;color:#fff;padding:0.5em 1em;border-radius:2em;display:inline-block;">${userQ}</span>`;
    chatbotMessages.appendChild(userMsg);

    const botA = chatbotFindAnswer(userQ);
    setTimeout(() => {
      const botMsg = document.createElement('div');
      botMsg.style = "margin:0.5em 0;text-align:left;";
      botMsg.innerHTML = `<span style="background:#23243a;color:#e0e6ed;padding:0.5em 1em;border-radius:2em;display:inline-block;">${botA}</span>`;
      chatbotMessages.appendChild(botMsg);
      chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    }, 400);

    chatbotInput.value = '';
    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
  };
});
  </script>
  <script>
function fetchAPOD() {
  fetch('https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY')
    .then(r => r.json())
    .then(data => {
      renderAPOD(data);
      renderHomeAPOD(data);
    })
    .catch(() => {
      renderAPOD(sampleAPOD);
      renderHomeAPOD(sampleAPOD);
    });
}
  </script>
</body>
</html>
